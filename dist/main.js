function requestData(){fetch("data.json").then((function(n){n.json().then((function(n){dataFromServer=n}))}))}
function localStorageSave(t){let a=JSON.stringify(t);localStorage.setItem("tasks",a)}function localStorageGet(){let t=localStorage.getItem("tasks");return tasks=t?JSON.parse(t):[],tasks}
function Tasks(s){[this.task,this.descryption,this.status,this.priority]=[...s]}
let getElement=e=>{switch(e){case"addBtn":return document.getElementById("add-btn");case"saveBtn":return document.getElementById("save");case"addForm":return document.getElementById("form");case"closeBtn":return document.getElementById("close");case"deleteBtn":return document.getElementById("delete");case"toDoSelect":return document.getElementById("todo-example-select");case"toDoSelectDoes":return document.getElementById("todo-example-select-does");case"statusSelect":return document.getElementById("status");case"prioritySelect":return document.getElementById("priority")}};getFormValues=()=>[getElement("toDoSelect").selectedOptions[0].value,getElement("toDoSelectDoes").value,getElement("statusSelect").selectedOptions[0].value,getElement("prioritySelect").selectedOptions[0].value],clearForm=()=>{getElement("toDoSelect").innerHTML="",getElement("statusSelect").innerHTML="",getElement("prioritySelect").innerHTML="",getElement("toDoSelectDoes").value=""},clearTasks=()=>document.getElementById("tasks").innerHTML="",showTasks=()=>{tasks.forEach((function(e,t){showTask(t)}))},showTask=e=>{$("<div/>",{class:"alert alert-primary d-flex justify-content-between",role:"alert","data-item":e,html:e+1+" "+tasks[e].descryption}).appendTo($("#tasks")).append($("<button/>",{class:"btn-warning btn",type:"button",html:"Edit"}))},renewTasks=()=>{clearForm(),clearTasks(),showTasks()};
var dataFromServer,tasks;requestData(),tasks=localStorageGet(),clearTasks(),showTasks();
getElement("toDoSelect").addEventListener("change",(function(){getElement("toDoSelectDoes").value=dataFromServer.defaultsDoes[getElement("toDoSelect").selectedIndex]})),getElement("closeBtn").addEventListener("click",(function(){getElement("addForm").removeAttribute("data-edit"),getElement("addForm").classList.add("hidden"),renewTasks()})),getElement("deleteBtn").addEventListener("click",(function(){let e=getElement("addForm").getAttribute("data-edit");e&&(tasks.splice(e,1),getElement("addForm").removeAttribute("data-edit"),getElement("addForm").classList.add("hidden"),renewTasks(),localStorageSave(tasks))})),getElement("saveBtn").addEventListener("click",(function(){let e=getElement("addForm").getAttribute("data-edit");if(getElement("addForm").classList.add("hidden"),e)tasks[e]=new Tasks(getFormValues());else{let e=new Tasks(getFormValues());tasks.push(e)}getElement("addForm").removeAttribute("data-edit"),renewTasks(),localStorageSave(tasks)})),getElement("addBtn").addEventListener("click",(function(){getElement("addForm").classList.remove("hidden"),dataFromServer.defaults.forEach((function(e,t){$("<option/>",{html:e,"data-id":t}).appendTo(getElement("toDoSelect"))})),dataFromServer.status.forEach((function(e,t){$("<option/>",{html:e,"data-id":t}).appendTo(getElement("statusSelect"))})),dataFromServer.priority.forEach((function(e,t){$("<option/>",{html:e,"data-id":t}).appendTo(getElement("prioritySelect"))}))})),$("#tasks").click((function(e){let t=e.target,a=t.parentElement.dataset.item;"button"===t.type&&(getElement("addForm").classList.remove("hidden"),getElement("addForm").setAttribute("data-edit",a),$("<option/>",{html:tasks[a].task}).appendTo(getElement("toDoSelect")),$("<option/>",{html:tasks[a].status,class:"choosen"}).appendTo(getElement("statusSelect")),dataFromServer.status.forEach((function(e,t){$("<option/>",{html:e}).appendTo(getElement("statusSelect"))})),$("<option/>",{html:tasks[a].priority,class:"choosen"}).appendTo(getElement("prioritySelect")),dataFromServer.priority.forEach((function(e,t){$("<option/>",{html:e}).appendTo(getElement("prioritySelect"))})),getElement("toDoSelectDoes").value=tasks[a].descryption)}));